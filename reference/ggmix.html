<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Linear Mixed Model with Lasso or Group Lasso Regularization — ggmix • ggmix</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Fit Linear Mixed Model with Lasso or Group Lasso Regularization — ggmix" />
<meta property="og:description" content="Main function to fit the linear mixed model with lasso or group
  lasso penalty for a sequence of tuning parameters. This is a penalized
  regression method that accounts for population structure using either the
  kinship matrix or the factored realized relationship matrix" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggmix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction-to-ggmix.html">Introduction to ggmix</a>
    </li>
    <li>
      <a href="../articles/prior-annotation-weights.html">Prior annotation weights</a>
    </li>
    <li>
      <a href="../articles/alternative-kinship-input.html">Alternative input for population structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sahirbhatnagar/ggmix">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Linear Mixed Model with Lasso or Group Lasso Regularization</h1>
    <small class="dont-index">Source: <a href='https://github.com/sahirbhatnagar/ggmix/blob/master/R/ggmix.R'><code>R/ggmix.R</code></a></small>
    <div class="hidden name"><code>ggmix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Main function to fit the linear mixed model with lasso or group
  lasso penalty for a sequence of tuning parameters. This is a penalized
  regression method that accounts for population structure using either the
  kinship matrix or the factored realized relationship matrix</p>
    </div>

    <pre class="usage"><span class='fu'>ggmix</span>(
  <span class='no'>x</span>,
  <span class='no'>y</span>,
  <span class='no'>U</span>,
  <span class='no'>D</span>,
  <span class='no'>kinship</span>,
  <span class='no'>K</span>,
  <span class='no'>n_nonzero_eigenvalues</span>,
  <span class='no'>n_zero_eigenvalues</span>,
  <span class='kw'>estimation</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"full"</span>),
  <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lasso"</span>),
  <span class='no'>group</span>,
  <span class='kw'>penalty.factor</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='no'>p_design</span>),
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>lambda_min_ratio</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>n_design</span> <span class='kw'>&lt;</span> <span class='no'>p_design</span>, <span class='fl'>0.01</span>, <span class='fl'>1e-04</span>),
  <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>eta_init</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>fdev</span> <span class='kw'>=</span> <span class='fl'>1e-20</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>thresh_glmnet</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>,
  <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>,
  <span class='kw'>dfmax</span> <span class='kw'>=</span> <span class='no'>p_design</span> + <span class='fl'>2</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>0</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>input matrix, of dimension n x p; where n is the number of
observations and p are the number of predictors.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable. must be a quantitative variable</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>left singular vectors corresponding to the non-zero eigenvalues
provided in the <code>D</code> argument.</p></td>
    </tr>
    <tr>
      <th>D</th>
      <td><p>non-zero eigenvalues. This option is provided to the user should
they decide or need to calculate the eigen decomposition of the kinship
matrix or the singular value decomposition of the matrix of SNPs used to
calculate the kinship outside of this function. This may occur, if for
example, it is easier (e.g. because of memory issues, it's easier to
calculate in plink). This should correspond to the non-zero eigenvalues
only. Note that if you are doing an <code>svd</code> on the matrix of SNPs used
to calculate the kinship matrix, then you must provide the square of the
singular values so that they correspond to the eigenvalues of the kinship
matrix. If you want to use the low rank estimation algorithm, you must
provide the truncated eigenvalues and eigenvectors to the <code>D</code> and
<code>U</code> arguments, respectively. If you want <code>ggmix</code> to truncate the
eigenvectors and eigenvalues for low rank estimation, then provide either
<code>K</code> or <code>kinship</code> instead and specify
<code>n_nonzero_eigenvalues</code>.</p></td>
    </tr>
    <tr>
      <th>kinship</th>
      <td><p>positive definite kinship matrix</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>the matrix of SNPs used to determine the kinship matrix</p></td>
    </tr>
    <tr>
      <th>n_nonzero_eigenvalues</th>
      <td><p>the number of nonzero eigenvalues. This argument
is only used when <code>estimation="low"</code> and either <code>kinship</code> or
<code>K</code> is provided. This argument will limit the function to finding the
<code>n_nonzero_eigenvalues</code> largest eigenvalues. If <code>U</code> and <code>D</code>
have been provided, then <code>n_nonzero_eigenvalues</code> defaults to the
length of <code>D</code>.</p></td>
    </tr>
    <tr>
      <th>n_zero_eigenvalues</th>
      <td><p>Currently not being used. Represents the number of
zero eigenvalues. This argument must be specified when <code>U</code> and
<code>D</code> are specified and <code>estimation="low"</code>. This is required for
low rank estimation because the number of zero eigenvalues and their
corresponding eigenvalues appears in the likelihood. In general this would
be the rank of the matrix used to calculate the eigen or singular value
decomposition. When <code>kinship</code> is provided and <code>estimation="low"</code>
the default value will be <code>nrow(kinship) - n_nonzero_eigenvalues</code>.
When <code>K</code> is provided and <code>estimation="low"</code>, the default value is
<code>rank(K) - n_nonzero_eigenvalues</code></p></td>
    </tr>
    <tr>
      <th>estimation</th>
      <td><p>type of estimation. Currently only <code>type="full"</code> has
been implemented.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>type of regularization penalty. Currently, only
penalty="lasso" has been implemented.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>a vector of consecutive integers describing the grouping of the
coefficients. Currently not implemented, but will be used when
penalty="gglasso" is implemented.</p></td>
    </tr>
    <tr>
      <th>penalty.factor</th>
      <td><p>Separate penalty factors can be applied to each
coefficient. This is a number that multiplies lambda to allow differential
shrinkage. Can be 0 for some variables, which implies no shrinkage, and
that variable is always included in the model. Default is 1 for all
variables</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user supplied lambda sequence (this is the tuning parameter).
Typical usage is to have the program compute its own lambda sequence based
on nlambda and lambda.min.ratio. Supplying a value of lambda overrides
this. WARNING: use with care. Do not supply a single value for lambda (for
predictions after CV use predict() instead). Supply instead a decreasing
sequence of lambda values. glmnet relies on its warms starts for speed, and
its often faster to fit a whole path than compute a single fit.</p></td>
    </tr>
    <tr>
      <th>lambda_min_ratio</th>
      <td><p>Smallest value for lambda, as a fraction of
lambda.max, the (data derived) entry value (i.e. the smallest value for
which all coefficients are zero). The default depends on the sample size
nobs relative to the number of variables nvars. If nobs &gt; nvars, the
default is 0.0001, close to zero. If nobs &lt; nvars, the default is 0.01. A
very small value of lambda.min.ratio will lead to a saturated fit in the
nobs &lt; nvars case.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>the number of lambda values - default is 100.</p></td>
    </tr>
    <tr>
      <th>eta_init</th>
      <td><p>initial value for the eta parameter, with \(0 &lt; \eta &lt; 1\)
used in determining lambda.max and starting value for fitting algorithm.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>Maximum number of passes over the data for all lambda values;
default is 10^2.</p></td>
    </tr>
    <tr>
      <th>fdev</th>
      <td><p>Fractional deviance change threshold. If change in deviance
between adjacent lambdas is less than fdev, the solution path stops early.
factory default = 1.0e-5</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>Logical flag for x variable standardization, prior to
fitting the model sequence. The coefficients are always returned on the
original scale. Default is standardize=FALSE. If variables are in the same
units already, you might not wish to standardize.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The elasticnet mixing parameter, with \(0 \leq \alpha \leq
1\). alpha=1 is the lasso penalty, and alpha=0 the ridge penalty.</p></td>
    </tr>
    <tr>
      <th>thresh_glmnet</th>
      <td><p>Convergence threshold for coordinate descent for
updating beta parameters. Each inner coordinate-descent loop continues
until the maximum change in the objective after any coefficient update is
less than thresh times the null deviance. Defaults value is 1E-7</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>Convergence threshold for block relaxation of the entire
parameter vector \(\Theta = ( \beta, \eta, \sigma^2 )\). The algorithm
converges when $$crossprod(\Theta_{j+1} - \Theta_{j}) &lt; \epsilon$$.
Defaults value is 1E-7</p></td>
    </tr>
    <tr>
      <th>dfmax</th>
      <td><p>limit the maximum number of variables in the model. Useful for
very large <code>p</code> (the total number of predictors in the design matrix),
if a partial path is desired. Default is the number of columns in the
design matrix + 2 (for the variance components)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>display progress. Can be either 0,1 or 2. 0 will not display
any progress, 2 will display very detailed progress and 1 is somewhere in
between. Default: 0.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bhatnagar, Sahir R, Yang, Yi, Lu, Tianyuan, Schurr, Erwin,
  Loredo-Osti, JC, Forest, Marie, Oualkacha, Karim, and Greenwood, Celia MT.
  (2020) <em>Simultaneous SNP selection and adjustment for population
  structure in high dimensional prediction models</em>
  <a href='https://doi.org/10.1101/408484'>https://doi.org/10.1101/408484</a></p>
<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) <em>Regularization
  Paths for Generalized Linear Models via Coordinate Descent</em>,
  <a href='http://www.stanford.edu/~hastie/Papers/glmnet.pdf'>http://www.stanford.edu/~hastie/Papers/glmnet.pdf</a> <em>Journal of
  Statistical Software, Vol. 33(1), 1-22 Feb 2010</em>
  <a href='http://www.jstatsoft.org/v33/i01/'>http://www.jstatsoft.org/v33/i01/</a></p>
<p>Yang, Y., &amp; Zou, H. (2015). A fast unified algorithm for solving
  group-lasso penalize learning problems. <em>Statistics and Computing</em>,
  25(6), 1129-1141.
  <a href='http://www.math.mcgill.ca/yyang/resources/papers/gglasso.pdf'>http://www.math.mcgill.ca/yyang/resources/papers/gglasso.pdf</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>admixed</span>)
<span class='no'>fitlmm</span> <span class='kw'>&lt;-</span> <span class='fu'>ggmix</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>admixed</span>$<span class='no'>xtrain</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>admixed</span>$<span class='no'>ytrain</span>,
                <span class='kw'>kinship</span> <span class='kw'>=</span> <span class='no'>admixed</span>$<span class='no'>kin_train</span>,
                <span class='kw'>estimation</span> <span class='kw'>=</span> <span class='st'>"full"</span>)
<span class='no'>gicfit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gic.html'>gic</a></span>(<span class='no'>fitlmm</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>gicfit</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"nonzero"</span>)</div><div class='output co'>#&gt;                       1
#&gt; (Intercept) -0.03660806
#&gt; X302        -0.17607392
#&gt; X524         1.34951500
#&gt; X538        -0.72052613
#&gt; eta          0.99000000
#&gt; sigma2       1.60476289</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gicfit</span>, <span class='kw'>newx</span> <span class='kw'>=</span> <span class='no'>admixed</span>$<span class='no'>xtest</span>)[<span class='fl'>1</span>:<span class='fl'>5</span>,,<span class='kw'>drop</span><span class='kw'>=</span><span class='fl'>FALSE</span>]</div><div class='output co'>#&gt;                1
#&gt; id26  2.31027410
#&gt; id39  0.86922183
#&gt; id45 -0.12814532
#&gt; id52 -0.03660806
#&gt; id53 -0.21268198</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gicfit</span>)</div><div class='img'><img src='ggmix-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fitlmm</span>)</div><div class='img'><img src='ggmix-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://sahirbhatnagar.com'>Sahir Bhatnagar</a>, <a href='https://karimoualkacha.uqam.ca/'>Karim Oualkacha</a>, <a href='http://www.math.mcgill.ca/yyang/'>Yi Yang</a>, <a href='https://www.mcgill.ca/statisticalgenetics/'>Celia Greenwood</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'f8a14d62b00c65f3af4a90aa62a286b8',
    indexName: 'ggmix',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


